# ---------------------------------------------------------
# mypy configuration for Animica contracts (strict subset)
# ---------------------------------------------------------
# Philosophy:
# - Contracts and stdlib modules are checked in (almost) strict mode.
# - Dev tooling and tests are relaxed for ergonomics.
# - External runtime deps are optional; if not installed, we
#   suppress "missing import" noise via per-module overrides.
#
# Run:
#   mypy --config-file contracts/mypy.ini
#
# Targets:
#   - Python 3.11
#   - Deterministic, well-typed contract surface

[mypy]
python_version = 3.11
files = contracts

# Start with very strict defaults for contract code
strict = True

# Extra clarity + helpful diagnostics
show_error_codes = True
pretty = True
color_output = True
error_summary = True
warn_unused_ignores = True
warn_redundant_casts = True
warn_unreachable = True
strict_equality = True
implicit_reexport = False
no_implicit_optional = True

# Import handling: we want signal when stubs are missing in core contract code,
# but we relax for specific external modules below.
follow_imports = normal
ignore_missing_imports = False
disallow_any_unimported = True

# ----------------------------
# Per-package / path overrides
# ----------------------------

# Tools (builder/ABI/deploy helpers): keep type checks reasonable but not strict.
[mypy-contracts.tools.*]
strict = False
disallow_untyped_defs = False
disallow_incomplete_defs = False
disallow_untyped_calls = False
warn_return_any = False
ignore_missing_imports = True

# Tests: ergonomic and fast; allow untyped test helpers/fixtures.
[mypy-contracts.tests.*]
strict = False
check_untyped_defs = False
warn_unused_ignores = False
ignore_missing_imports = True

# Examples & templates: encourage typing, but permit optional deps to be absent.
[mypy-contracts.examples.*]
strict = True
ignore_missing_imports = True

[mypy-contracts.templates.*]
strict = True
ignore_missing_imports = True

# Stdlib (on-chain reusable components): keep strict to ensure high quality.
[mypy-contracts.stdlib.*]
strict = True
ignore_missing_imports = False

# Interfaces/ABIs (JSON files are not type-checked; any helper modules keep strict)
[mypy-contracts.interfaces.*]
strict = True
ignore_missing_imports = True

# Fixtures: not production code
[mypy-contracts.fixtures.*]
strict = False
ignore_missing_imports = True

# ----------------------------
# Optional external integrations
# (suppress missing-import noise if not installed locally)
# ----------------------------
[mypy-omni_sdk.*]
ignore_missing_imports = True

[mypy-vm_py.*]
ignore_missing_imports = True

[mypy-pq.*]
ignore_missing_imports = True

[mypy-core.*]
ignore_missing_imports = True

[mypy-execution.*]
ignore_missing_imports = True

[mypy-capabilities.*]
ignore_missing_imports = True

[mypy-msgspec.*]
ignore_missing_imports = True

[mypy-typing_extensions.*]
ignore_missing_imports = True

# If you vendor or generate code into these paths later, you can relax checks:
# [mypy-contracts/vendor.*]
# strict = False
# ignore_missing_imports = True

{
  "abiVersion": 1,
  "name": "AiAgent",
  "functions": [
    {
      "name": "owner",
      "stateMutability": "view",
      "inputs": [],
      "outputs": [
        {
          "type": {
            "abiType": "address"
          },
          "name": "addr"
        }
      ]
    },
    {
      "name": "model",
      "stateMutability": "view",
      "inputs": [],
      "outputs": [
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "name",
          "docs": "UTF-8 model identifier (e.g., b\"animica/text-ada-001\")."
        }
      ]
    },
    {
      "name": "setModel",
      "stateMutability": "nonpayable",
      "inputs": [
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "name"
        }
      ],
      "outputs": [
        {
          "type": {
            "abiType": "bool"
          },
          "name": "ok"
        }
      ],
      "docs": "Owner-only: update default model used by enqueue()."
    },
    {
      "name": "lastPrompt",
      "stateMutability": "view",
      "inputs": [],
      "outputs": [
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "prompt"
        }
      ]
    },
    {
      "name": "lastTaskId",
      "stateMutability": "view",
      "inputs": [],
      "outputs": [
        {
          "type": {
            "abiType": "bytes32"
          },
          "name": "task_id"
        }
      ]
    },
    {
      "name": "lastResult",
      "stateMutability": "view",
      "inputs": [],
      "outputs": [
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "result"
        }
      ],
      "docs": "Cached last consumed result (set by consume())."
    },
    {
      "name": "enqueue",
      "stateMutability": "nonpayable",
      "inputs": [
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "prompt",
          "docs": "UTF-8 prompt bytes. Size capped by contract code."
        },
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "modelOverride",
          "docs": "Optional; pass b'' to use current model()."
        }
      ],
      "outputs": [
        {
          "type": {
            "abiType": "bytes32"
          },
          "name": "task_id"
        }
      ],
      "docs": "Enqueue prompt to AICF. Returns deterministic task_id (H(chainId|height|txHash|caller|payload))."
    },
    {
      "name": "hasResult",
      "stateMutability": "view",
      "inputs": [
        {
          "type": {
            "abiType": "bytes32"
          },
          "name": "task_id"
        }
      ],
      "outputs": [
        {
          "type": {
            "abiType": "bool"
          },
          "name": "available"
        }
      ],
      "docs": "True if a result is available (typically next block or later)."
    },
    {
      "name": "readResult",
      "stateMutability": "view",
      "inputs": [
        {
          "type": {
            "abiType": "bytes32"
          },
          "name": "task_id"
        }
      ],
      "outputs": [
        {
          "type": {
            "abiType": "bool"
          },
          "name": "available"
        },
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "result"
        }
      ],
      "docs": "Read result without mutating state; returns (available, result)."
    },
    {
      "name": "consume",
      "stateMutability": "nonpayable",
      "inputs": [
        {
          "type": {
            "abiType": "bytes32"
          },
          "name": "task_id"
        }
      ],
      "outputs": [
        {
          "type": {
            "abiType": "bool"
          },
          "name": "ok"
        },
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "result"
        }
      ],
      "docs": "Consume available result: caches into lastResult and emits Consumed(task_id,...). Reverts if not available."
    },
    {
      "name": "transferOwnership",
      "stateMutability": "nonpayable",
      "inputs": [
        {
          "type": {
            "abiType": "address"
          },
          "name": "newOwner"
        }
      ],
      "outputs": [
        {
          "type": {
            "abiType": "bool"
          },
          "name": "ok"
        }
      ]
    }
  ],
  "events": [
    {
      "name": "Enqueued",
      "inputs": [
        {
          "type": {
            "abiType": "bytes32"
          },
          "name": "task_id",
          "indexed": true
        },
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "model",
          "indexed": false
        },
        {
          "type": {
            "abiType": "u32"
          },
          "name": "promptLen",
          "indexed": false
        }
      ]
    },
    {
      "name": "Consumed",
      "inputs": [
        {
          "type": {
            "abiType": "bytes32"
          },
          "name": "task_id",
          "indexed": true
        },
        {
          "type": {
            "abiType": "u32"
          },
          "name": "resultLen",
          "indexed": false
        }
      ]
    },
    {
      "name": "ModelUpdated",
      "inputs": [
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "oldModel",
          "indexed": false
        },
        {
          "type": {
            "abiType": "bytes"
          },
          "name": "newModel",
          "indexed": false
        }
      ]
    },
    {
      "name": "OwnershipTransferred",
      "inputs": [
        {
          "type": {
            "abiType": "address"
          },
          "name": "previousOwner",
          "indexed": true
        },
        {
          "type": {
            "abiType": "address"
          },
          "name": "newOwner",
          "indexed": true
        }
      ]
    }
  ],
  "errors": [
    {
      "name": "NotOwner",
      "inputs": []
    },
    {
      "name": "EmptyPrompt",
      "inputs": []
    },
    {
      "name": "PromptTooLarge",
      "inputs": []
    },
    {
      "name": "NoResultYet",
      "inputs": []
    }
  ],
  "docs": "Minimal AI agent that enqueues prompts to AICF, tracks last task id, and (next block) reads/consumes results deterministically."
}
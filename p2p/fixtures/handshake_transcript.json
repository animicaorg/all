{
  "version": 1,
  "network": "animica:1337",
  "cipher_suites": [
    "KEM: Kyber768",
    "KDF: HKDF-SHA3-256",
    "AEAD: chacha20-poly1305"
  ],
  "initiator": {
    "role": "initiator",
    "static_signing": {
      "alg": "dilithium3",
      "pubkey_hex": "bed2c7b4d6b0c433f2c4b8b53a9dd0c2f4a0f9d62a7b1a3d4c5e6f708192a3bc"
    },
    "peer_id_hex": "1e8d2b1a6f5c4d3e2f1098ab76c5d4e3b2a1908f7766554433221100ffeeddcc"
  },
  "responder": {
    "role": "responder",
    "static_signing": {
      "alg": "dilithium3",
      "pubkey_hex": "8a4f1b2c3d4e5f60718293a4b5c6d7e8f9012a34b56c78d9e0f1a2b3c4d5e6f7"
    },
    "peer_id_hex": "aabbccddeeff00112233445566778899deadbeefcafebabefeedface01234567"
  },

  "messages": [
    {
      "t": "2025-01-20T12:00:00Z",
      "dir": "I->R",
      "type": "CLIENT_HELLO",
      "payload": {
        "proto": "animica/1",
        "kem_pk_b64": "aW5pdF9reWJlcl9wdWJsaWNfZGVtbw==",
        "supported_aead": ["chacha20-poly1305", "aes-256-gcm"],
        "alg_policy_root_hex": "4f7a0d477f6c3a1a2b3c4d5e6f708192a3b4c5d6e7f8091a2b3c4d5e6f708192"
      },
      "transcript_hash_after_hex": "b9d4c51a1b9b6c3d0a5f8e7c0182f3d4b5a6978876655443322110ffeeddccbb"
    },
    {
      "t": "2025-01-20T12:00:00Z",
      "dir": "R->I",
      "type": "SERVER_HELLO",
      "payload": {
        "kem_ct_b64": "cmVzcF9reWJlcl9lbmNhcHNfZGVtbw==",
        "chosen_aead": "chacha20-poly1305",
        "responder_sig": {
          "alg": "dilithium3",
          "signature_hex": "f0e1d2c3b4a5968778695a4b3c2d1e0ffedcba98765432100123456789abcdef"
        }
      },
      "transcript_hash_after_hex": "0b2e4a6c8d9f10234567abdcef0192837465a1b2c3d4e5f60718293a4b5c6d7e"
    },
    {
      "t": "2025-01-20T12:00:01Z",
      "dir": "I->R",
      "type": "CLIENT_FINISH",
      "payload": {
        "initiator_sig": {
          "alg": "dilithium3",
          "signature_hex": "abcdef0123456789fedcba9876543210aa55aa55aa55aa55bb66bb66bb66bb66"
        }
      },
      "transcript_hash_after_hex": "8c7b6a59483726150493abcedef01234aabbccddeeff00112233445566778899"
    }
    /* AEAD-protected traffic follows after keys are derived */
  ],

  "hkdf": {
    "salt_hex": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f",
    "info": "animica/p2p handshake v1",
    "ikm_desc": "Kyber768 shared secret",
    "prk_hex": "9c31be1d7a3c5e8f00aabbccddeeff11223344556677889900aabbccddeeff11",
    "aead_keys": {
      "initiator_tx_key_hex": "11223344556677889900aabbccddeeff00112233445566778899aabbccddeeff",
      "initiator_rx_key_hex": "ffeeddccbbaa9988776655443322110000112233445566778899aabbccddeeff",
      "responder_tx_key_hex": "ffeeddccbbaa9988776655443322110000112233445566778899aabbccddeeff",
      "responder_rx_key_hex": "11223344556677889900aabbccddeeff00112233445566778899aabbccddeeff"
    },
    "nonce_schedule": "uint64 little-endian counter per direction; starts at 0; increment per frame"
  },

  "aead": {
    "name": "chacha20-poly1305",
    "tag_bytes": 16,
    "key_bytes": 32,
    "nonce_bytes": 12,
    "rekey_after_messages": 1000000,
    "rekey_after_seconds": 86400
  },

  "security_properties": {
    "pfs": true,
    "peer_authentication": "static Dilithium3 signatures over transcript",
    "server_auth_bound_to": "SERVER_HELLO (kem_ct + params + transcript-hash-before)",
    "client_auth_bound_to": "CLIENT_FINISH (params + transcript-hash-before)"
  },

  "notes": [
    "All fields are illustrative; keys and signatures are non-sensitive test values.",
    "The transcript hashes are SHA3-256 over concatenated frame headers and payloads in canonical form.",
    "Implementations must derive distinct TX/RX keys based on role to avoid key reuse."
  ]
}

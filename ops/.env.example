# ------------------------------------------------------------------------------
# Animica Public Devnet — .env.example
# Copy to ops/.env and adjust for your environment.
# ------------------------------------------------------------------------------

# --------------------------- Domain & TLS --------------------------------------
# Base domain used for subdomains below (e.g., devnet.example.com).
DOMAIN_BASE=devnet.example.com

# ACME contact email for TLS certs (Caddy/nginx + Certbot).
ACME_EMAIL=ops@example.com

# Public hostnames for each surface (override if you use path-based routing).
RPC_HOST=rpc.${DOMAIN_BASE}
WS_HOST=ws.${DOMAIN_BASE}
OPENRPC_HOST=openrpc.${DOMAIN_BASE}
DA_HOST=da.${DOMAIN_BASE}
API_HOST=api.${DOMAIN_BASE}
EXPLORER_HOST=explorer.${DOMAIN_BASE}
STUDIO_HOST=studio.${DOMAIN_BASE}
P2P_SEEDS_HOST=p2p.${DOMAIN_BASE}

# --------------------------- Chain --------------------------------------------
# Devnet chain ID (CAIP-2 suffix is animica:1337).
CHAIN_ID=1337
CHAIN_NAMESPACE=animica

# --------------------------- Images & Tags ------------------------------------
# Prefer immutable tags or digests for public deployments.
IMAGE_TAG=latest
CORE_IMAGE=ghcr.io/animica/core:${IMAGE_TAG}
RPC_IMAGE=ghcr.io/animica/rpc:${IMAGE_TAG}
P2P_IMAGE=ghcr.io/animica/p2p:${IMAGE_TAG}
DA_IMAGE=ghcr.io/animica/da:${IMAGE_TAG}
AICF_IMAGE=ghcr.io/animica/aicf:${IMAGE_TAG}
MINING_IMAGE=ghcr.io/animica/mining:${IMAGE_TAG}
RANDOMNESS_IMAGE=ghcr.io/animica/randomness:${IMAGE_TAG}
STUDIO_SERVICES_IMAGE=ghcr.io/animica/studio-services:${IMAGE_TAG}
EXPLORER_WEB_IMAGE=ghcr.io/animica/explorer-web:${IMAGE_TAG}
STUDIO_WEB_IMAGE=ghcr.io/animica/studio-web:${IMAGE_TAG}

# Optional overrides for private registries (leave blank to use defaults above).
DOCKER_REGISTRY_OVERRIDE=
PULL_POLICY=always

# --------------------------- Public URLs --------------------------------------
RPC_HTTP_URL=https://${RPC_HOST}/rpc
RPC_WS_URL=wss://${WS_HOST}/ws
OPENRPC_URL=https://${OPENRPC_HOST}/openrpc.json
DA_API_URL=https://${DA_HOST}
SERVICES_URL=https://${API_HOST}
EXPLORER_URL=https://${EXPLORER_HOST}
STUDIO_URL=https://${STUDIO_HOST}

# --------------------------- Local Ports (containers/compose) -----------------
# These are container/service ports; the reverse proxy should expose 443 publicly.
RPC_HTTP_PORT=8545
RPC_WS_PORT=8546
P2P_TCP_PORT=30303
P2P_QUIC_PORT=30304
DA_API_PORT=8688
SERVICES_PORT=8787
EXPLORER_PORT=8081
STUDIO_PORT=8082
PROM_PORT=9090
GRAFANA_PORT=3000

# --------------------------- CORS / Origins -----------------------------------
# Comma-separated allow-list for browser origins that may call RPC/Services.
CORS_ALLOW_ORIGINS=https://${STUDIO_HOST},https://${EXPLORER_HOST},http://localhost:5173,http://localhost:5174

# --------------------------- P2P Seeds & Discovery ----------------------------
# Seed hosts advertised to new peers (comma-separated). Use A/AAAA records.
P2P_SEED_HOSTS=p2p1.${DOMAIN_BASE}:30303,p2p2.${DOMAIN_BASE}:30303

# Optional multiaddrs (if you run QUIC and/or non-default ports).
P2P_SEED_MULTIADDRS=/dns4/p2p1.${DOMAIN_BASE}/tcp/30303,/dns4/p2p2.${DOMAIN_BASE}/udp/30304/quic

# Public advertise addresses (if behind NAT; otherwise nodes derive automatically).
P2P_ADVERTISE_TCP=/dns4/${P2P_SEEDS_HOST}/tcp/${P2P_TCP_PORT}
P2P_ADVERTISE_QUIC=/dns4/${P2P_SEEDS_HOST}/udp/${P2P_QUIC_PORT}/quic

# --------------------------- Rate Limits (sane devnet defaults) ---------------
# RPC ingress (global and per-IP)
RPC_RATE_GLOBAL_TXS_PER_SEC=50
RPC_RATE_GLOBAL_BYTES_PER_SEC=5242880      # 5 MiB/s
RPC_RATE_PER_IP_TXS_PER_SEC=10
RPC_RATE_PER_IP_BYTES_PER_SEC=1048576      # 1 MiB/s

# Studio-Services (deploy/verify/faucet)
SERV_RATE_GLOBAL_REQS_PER_SEC=20
SERV_RATE_PER_IP_REQS_PER_SEC=5

# DA API (POST/GET/blob/proof)
DA_RATE_GLOBAL_REQS_PER_SEC=30
DA_MAX_UPLOAD_MIB=64

# --------------------------- Faucet (devnet only) -----------------------------
SERVICES_FAUCET_ENABLED=true
SERVICES_FAUCET_CHAIN_ID=${CHAIN_ID}
SERVICES_FAUCET_API_KEY=put-dev-key-here
SERVICES_FAUCET_DRIP_AMOUNT=1000000000     # units (example)
SERVICES_FAUCET_COOLDOWN_SEC=3600          # per address/IP

# --------------------------- Services ↔ Node wiring ---------------------------
# Studio-Services upstream to node RPC.
SERVICES_RPC_URL=http://rpc:${RPC_HTTP_PORT}/rpc
SERVICES_CHAIN_ID=${CHAIN_ID}

# DA service internal URL (used by adapters, if mounted together)
SERVICES_DA_URL=http://da:${DA_API_PORT}

# --------------------------- Logging & Metrics --------------------------------
LOG_LEVEL=info
ENABLE_PROMETHEUS=true
ENABLE_STRUCTURED_LOGS=true

# --------------------------- Explorer / Studio configuration ------------------
# These are passed into the SPAs at build/runtime via env or reverse-proxy.
EXPLORER_RPC_URL=${RPC_HTTP_URL}
EXPLORER_CHAIN_ID=${CHAIN_ID}
EXPLORER_SERVICES_URL=${SERVICES_URL}

STUDIO_RPC_URL=${RPC_HTTP_URL}
STUDIO_CHAIN_ID=${CHAIN_ID}
STUDIO_SERVICES_URL=${SERVICES_URL}

# --------------------------- Randomness / Beacon ------------------------------
# Round and VDF params typically live in spec/params.yaml; these are only for ops hints.
RAND_VDF_ENABLE=true

# --------------------------- Misc ---------------------------------------------
# If you host OpenRPC separately or via the RPC app.
OPENRPC_ENABLE_MOUNT=true

# If running Prometheus/Grafana locally via ops/metrics/docker-compose.yml
METRICS_STACK_ENABLE=false

# --------------------------- Local Dev Convenience ----------------------------
# For local testing without TLS, you can point the public URLs to localhost and
# use http/ws schemes. (Your reverse-proxy config must match.)
# RPC_HTTP_URL=http://localhost:${RPC_HTTP_PORT}/rpc
# RPC_WS_URL=ws://localhost:${RPC_WS_PORT}/ws
# DA_API_URL=http://localhost:${DA_API_PORT}
# SERVICES_URL=http://localhost:${SERVICES_PORT}
# EXPLORER_URL=http://localhost:${EXPLORER_PORT}
# STUDIO_URL=http://localhost:${STUDIO_PORT}

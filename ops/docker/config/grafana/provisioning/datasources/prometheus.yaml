# Grafana provisioning: Prometheus datasource
# This is loaded on Grafana startup (GF_PATHS_PROVISIONING=/etc/grafana/provisioning).
# You can override the target URL via PROMETHEUS_URL env (defaults to the compose
# service name "prometheus" on port 9090).

apiVersion: 1

deleteDatasources:
  - name: Prometheus
    orgId: 1

datasources:
  - name: Prometheus
    type: prometheus
    access: proxy
    orgId: 1
    isDefault: true
    editable: true
    # Use env var if provided, else fall back to the docker-compose service
    url: ${PROMETHEUS_URL:http://prometheus:9090}
    basicAuth: false
    jsonData:
      # Minimal sane defaults; can be tuned with env below
      timeInterval: ${PROMETHEUS_SCRAPE_INTERVAL:15s}  # how often Grafana queries Prom
      httpMethod: POST
      manageAlerts: true            # enable Grafana-managed alert rules against Prometheus
      cacheLevel: High              # Grafana >=9 cache hint (ignored by older versions)
    secureJsonData: {}
